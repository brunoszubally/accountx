RewriteEngine On

# Csak GET kérések engedélyezése
RewriteCond %{REQUEST_METHOD} !GET
RewriteRule ^ - [F]

# PHP fájlok közvetlen elérése tiltása
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^.]+)\.php [NC]
RewriteRule ^ %1 [R=301,L]

# query_invoice.php endpoint
RewriteRule ^query_invoice$ query_invoice.php [L]

# Biztonság
Options -Indexes
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# PHP hibák elrejtése
php_flag display_errors off 